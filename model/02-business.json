{
  "version": "1.0",
  "description": "Business layer — actors, roles, processes, services and objects for the Archi Model API Server",
  "changes": [
    {
      "op": "createElement",
      "type": "business-actor",
      "name": "Enterprise Architect",
      "tempId": "actor-architect",
      "documentation": "Domain expert responsible for creating, maintaining, and evolving the enterprise ArchiMate model. Uses the API server directly through the archicli CLI or via scripts to automate repetitive modelling tasks and manage large-scale structural changes.",
      "folder": "Business"
    },
    { "op": "setProperty", "id": "actor-architect", "key": "layer", "value": "Business" },
    { "op": "setProperty", "id": "actor-architect", "key": "status", "value": "active" },
    { "op": "setProperty", "id": "actor-architect", "key": "persona", "value": "Human" },
    {
      "op": "createElement",
      "type": "business-actor",
      "name": "AI Coding Agent",
      "tempId": "actor-agent",
      "documentation": "Automated AI assistant or coding agent (e.g. Claude Code) that interacts with the API server to read model state, propose architecture changes, create elements, and build documentation. Relies on structured JSON output and progressive CLI help for discovery.",
      "folder": "Business"
    },
    { "op": "setProperty", "id": "actor-agent", "key": "layer", "value": "Business" },
    { "op": "setProperty", "id": "actor-agent", "key": "status", "value": "active" },
    { "op": "setProperty", "id": "actor-agent", "key": "persona", "value": "Automated" },
    {
      "op": "createElement",
      "type": "business-role",
      "name": "API Consumer",
      "tempId": "role-consumer",
      "documentation": "Role fulfilled by any actor that interacts with the Model API Server through HTTP requests. Encompasses both read (query) and write (apply) operations. Requires the server to be running and the model to be open in Archi.",
      "folder": "Business"
    },
    { "op": "setProperty", "id": "role-consumer", "key": "layer", "value": "Business" },
    { "op": "setProperty", "id": "role-consumer", "key": "status", "value": "active" },
    { "op": "setProperty", "id": "role-consumer", "key": "authentication", "value": "None (localhost only)" },
    {
      "op": "createElement",
      "type": "business-process",
      "name": "Apply Model Changes",
      "tempId": "proc-apply",
      "documentation": "Business process for submitting a batch of ArchiMate change operations (createElement, createRelationship, setProperty, etc.) via POST /model/apply. Operations are queued, executed on the SWT Display Thread, and wrapped in the GEF Command Stack for undo support. Returns an operationId for polling.",
      "folder": "Business"
    },
    { "op": "setProperty", "id": "proc-apply", "key": "layer", "value": "Business" },
    { "op": "setProperty", "id": "proc-apply", "key": "status", "value": "active" },
    { "op": "setProperty", "id": "proc-apply", "key": "endpoint", "value": "POST /model/apply" },
    { "op": "setProperty", "id": "proc-apply", "key": "execution-mode", "value": "Asynchronous" },
    {
      "op": "createElement",
      "type": "business-process",
      "name": "Query Model",
      "tempId": "proc-query",
      "documentation": "Business process for reading model state through POST /model/query (graph traversal with depth/filter options), POST /model/search (element search by type, name, property), or GET /model/element/{id} (single element detail). Executed synchronously via Display.asyncExec with CountDownLatch.",
      "folder": "Business"
    },
    { "op": "setProperty", "id": "proc-query", "key": "layer", "value": "Business" },
    { "op": "setProperty", "id": "proc-query", "key": "status", "value": "active" },
    { "op": "setProperty", "id": "proc-query", "key": "endpoint", "value": "POST /model/query, POST /model/search, GET /model/element/{id}" },
    { "op": "setProperty", "id": "proc-query", "key": "execution-mode", "value": "Synchronous" },
    {
      "op": "createElement",
      "type": "business-process",
      "name": "Manage Views",
      "tempId": "proc-views",
      "documentation": "Business process for creating, updating, and exporting ArchiMate views. Includes listing all views (GET /views), retrieving a single view (GET /views/{id}), creating views with elements (POST /views), auto-layout (POST /views/{id}/layout), and exporting as image or structured data (POST /views/{id}/export).",
      "folder": "Business"
    },
    { "op": "setProperty", "id": "proc-views", "key": "layer", "value": "Business" },
    { "op": "setProperty", "id": "proc-views", "key": "status", "value": "active" },
    { "op": "setProperty", "id": "proc-views", "key": "endpoint", "value": "GET /views, POST /views, POST /views/{id}/layout, POST /views/{id}/export" },
    {
      "op": "createElement",
      "type": "business-service",
      "name": "Model API Service",
      "tempId": "svc-model",
      "documentation": "Business service providing programmatic access to the ArchiMate model. Exposes CRUD operations on elements and relationships, batch change application with undo support, and rich model query capabilities. Delivered over HTTP on localhost:8765 with JSON request/response.",
      "folder": "Business"
    },
    { "op": "setProperty", "id": "svc-model", "key": "layer", "value": "Business" },
    { "op": "setProperty", "id": "svc-model", "key": "status", "value": "active" },
    { "op": "setProperty", "id": "svc-model", "key": "protocol", "value": "HTTP/JSON REST" },
    { "op": "setProperty", "id": "svc-model", "key": "base-url", "value": "http://127.0.0.1:8765" },
    {
      "op": "createElement",
      "type": "business-service",
      "name": "View Management Service",
      "tempId": "svc-view",
      "documentation": "Business service for managing ArchiMate diagram views — creating views from element sets, applying automatic Dagre graph layout, and exporting views as PNG images or structured JSON containing visual metadata (positions, sizes, styles).",
      "folder": "Business"
    },
    { "op": "setProperty", "id": "svc-view", "key": "layer", "value": "Business" },
    { "op": "setProperty", "id": "svc-view", "key": "status", "value": "active" },
    { "op": "setProperty", "id": "svc-view", "key": "export-formats", "value": "PNG, JSON" },
    {
      "op": "createElement",
      "type": "business-object",
      "name": "ArchiMate Model",
      "tempId": "obj-model",
      "documentation": "The enterprise ArchiMate model managed by Archi. Contains the full graph of elements, relationships, properties, and views. Persisted as an .archimate file on disk. All API operations read from or write to this live in-memory model instance.",
      "folder": "Business"
    },
    { "op": "setProperty", "id": "obj-model", "key": "layer", "value": "Business" },
    { "op": "setProperty", "id": "obj-model", "key": "status", "value": "active" },
    { "op": "setProperty", "id": "obj-model", "key": "format", "value": "Archi .archimate (XML)" }
  ]
}
